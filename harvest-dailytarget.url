javascript:(function(){var t=37.5,e=5;function i(t){var e=1.5;var i=[1.75,1.75,1.5,.5,.33,.25,.25,.25];if(t<.01||t>12)return 0;var n=0;i.forEach((function(i,a){var r=e*a;if(t>r){n+=Math.min(e,t-r)*i}}));return n}function n(t){if(t<.01||t>=9.87)return 0;var e=t/2;var n=t-i(e);var a=0;while(a<100&&Math.abs(n)>.01){a++;e=e+n/2;n=t-i(e)}if(a>=100)return 0;return e}$("head").append('<style type="text/css">td.entry-time:after{content:attr(title);color:#888;font-size:67%;position:absolute;right:17px;top:60%;}</style>');$(".js-timesheet-view").first().prepend('<div style="background:#f8f8f8;border:1px solid #e0e0e0;padding:0.5em;width:fit-content;margin:0 auto 1em auto;text-align:right"><b style="font-size:150%;margin-right:1em">Targets</b>'+' W:<input title="Weekly hours" type="number" id="__w_tgt" value="'+t+'" min="0" max="99" step="1">'+' D/W:<input title="Days per week" type="number" id="__w_l" value="'+e+'" min="1" max="7" step="1">'+' D:<input title="Daily hours" type="number" id="__d_tgt" min="0" max="24" step="0.01">'+' <b style="font-size:150%;margin-left:1em">ETA: <span id="__eta"></span></b>'+'<br>(<i>#min: <span id="__meta"></span></i>)</div>');var a=$("#__w_tgt"),r=$("#__w_l"),s=$("#__d_tgt"),u=$("#__eta"),d=$("#__meta");var m=function(){var t=Number(s.val()),e=Number($(".is-today .pds-text-sm").text()),a=Math.max(0,t-e),r=new Date((new Date).getTime()+a*36e5);u.html(a.toFixed(2)+"h until "+r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes());var m=0,o=0;$("table#day-view-entries tr.day-view-entry").each((function(){var t=$(this).find("div.entry-details div.notes").text(),e=Number($(this).find("td.entry-time").text());/#min/.test(t)?m+=e:o+=e}));var l=Math.max(0,n(t-o)-m),v=new Date((new Date).getTime()+l*36e5),f=Math.round((i(m)/m+Number.EPSILON)*100)/100;d.html(l.toFixed(2)+"h until "+v.getHours()+":"+(v.getMinutes()<10?"0":"")+v.getMinutes()+" "+f+"x so far");$("table#day-view-entries tr.day-view-entry").each((function(){var t=$(this).find("div.entry-details div.notes").text();e=Number($(this).find("td.entry-time").text());if(/#min/.test(t)){$(this).find("td.entry-time").attr("title",Math.round((e*f+Number.EPSILON)*100)/100)}}))};setInterval(m,2e3);s.on("input change",m);var o=function(){var t=Number(a.val())-Number($("#day-view-week-nav-total .test-week-total").text())+Number($(".is-today .pds-text-sm").text()),e=new Date,i=1+Number(r.val())-(e.getDay()==0?7:e.getDay());s.val(Number(t/i).toFixed(2));m()};o();a.on("input change",o);r.on("input change",o)})()
